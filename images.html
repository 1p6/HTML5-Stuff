<script>
document.ondragover = function(evt){
  evt.stopPropagation();
  evt.preventDefault();
  evt.dataTransfer.dropEffect = "copy";
}

var zindex = 0;

document.ondrop = function(evt){
  evt.stopPropagation();
  evt.preventDefault();
  
  var file = evt.dataTransfer.files[0];
  
  if(file == undefined) { return; }
  
  var reader = new FileReader();
  reader.onload = function(e){
    var img = document.createElement("img");
    img.src = e.target.result;
    img.style.position = "absolute";
    img.style.left = evt.clientX + "px";
    img.style.top = evt.clientY + "px";
    
    img.onmousedown = function(es){
      zindex++;
      img.style.z-index = zindex;
      
      document.onmousemove = function(ess){
        img.style.left = (ess.clientX - es.offsetX) + "px";
        img.style.top = (ess.clientY - es.offsetY) + "px";
      }
    }
    
    img.onmouseup = function(){
      document.onmousemove = function(){};
    }
    
    img.ondblclick = function(){
      document.body.removeChild(img);
    }
    
    document.body.appendChild(img);
  }
  reader.readAsDataURL(file);
}

document.ondragstart = function(evt){
  evt.preventDefault();
}
</script>
